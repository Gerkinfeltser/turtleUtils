-- Fills space in front until detected as filled
-- Works best with gravity obeying blocks
local tArgs = { ... }

local startDir = tArgs[1] or 0
local slotNum = tArgs[2] or 1
local startHeight = tArgs[3] or 0

-- Rotate into specified orientation
print("Getting situated...")
if startDir == "cw" then
    turtle.turnRight()
    print("Clockwise!")
elseif startDir == "ccw" then
    turtle.turnLeft()
    print("Counter-clockwise!")
end

-- Move to desired height
if startHeight ~= 0 then
    if startHeight > 0 then
        print("Moving on up...")
        for i = 1, math.abs(startHeight) do
            turtle.moveUp()
        end
    else then
        print("Moving on down...")
        for i = 1, math.abs(startHeight) do
            turtle.moveDown()
        end
    end
end

-- Start dropping
local filledCount = 0
print("Stand back!")

turtle.select(slotNum)
while not turtle.detect() do
    if turtle.getItemCount(slotNum) < 1 then
        print("Give me some-more or press [x] to quit, yo")
        -- limit os.pullEvent to the 'key' event
        local event, key = os.pullEvent( "key" ) 
        -- if the key pressed was 'x'
        if key == keys.x then
            print( "You pressed [x]. Aborting dump..." )
            break
        end
    end
    if turtle.place() then
        filledCount = filledCount + 1
    end
    sleep(0.1)
    turtle.detect()
end

if filledCount > 1 then
    print(filledCount, " dropped")
else
    print("I dropped no-thing!!!")
end