sleepLength = 30
digBlock = {name = "minecraft:melon", metadata = 0}
goalItem = "minecraft:melon"
goalSeed = nil

local function digIt()
	local success, data = turtle.inspectDown()
	if data == digBlock then
		turtle.select(1)
		turtle.digDown()
		for i=1, 16 do
			local success, data = turtle.getItemDetail(i)
			if data.name == goalItem then
				turtle.dropUp()
			end
		end
		if goalSeed then
			for i=1, 16 do
				local success, data = turtle.getItemDetail(i)
				if data.name == goalSeed then
					turtle.placeDown()
					return
				end
			end
		end
	end
	sleep(sleepLength)
end

term.clear()
term.setCursorPos(1,1)
print("Mellon, mon!")
print("Waiting for ".. digBlock.name.. " stage ".. digBlock.metadata)
if goalSeed then print("Replanting ".. goalSeed) end
print("ctrl+R to reboot, bah-ee!")

while true do
	digIt()
end