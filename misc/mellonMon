sleepLength = 30
digBlock = {name = "minecraft:melon_block", metadata = 0}
-- {name = "ExtraUtilities:plant/ender_lilly", metadata = 1}
goalItem = "minecraft:melon" 
-- "minecraft:ender_pearl"
goalSeed = nil
-- "ExtraUtilities:plant/ender_lilly"

local function digIt()
	local success, data = turtle.inspectDown()
	if success and data.name == digBlock.name and data.metadata == digBlock.metadata then
		turtle.select(1)
		turtle.digDown()
		for i=1, 16 do
			local success, data = turtle.getItemDetail(i)
			if success and data.name == goalItem then
				turtle.select(i)
				turtle.dropUp()
			end
		end
		if goalSeed then
			for i=1, 16 do
				local success, data = turtle.getItemDetail(i)
				if data.name == goalSeed then
					turtle.placeDown()
					return
				end
			end
		end
	end
	sleep(sleepLength)
end

term.clear()
term.setCursorPos(1,1)
print("Mellon, mon!")
print("Waiting for ".. digBlock.name.. ":".. digBlock.metadata)
if goalSeed ~= nil then print("Replanting ".. goalSeed) end
print("ctrl+R to reboot, bah-ee!")

while true do
	digIt()
end